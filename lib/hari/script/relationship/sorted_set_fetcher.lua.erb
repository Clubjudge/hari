function _h.sorted_set_fetch_relations_ids(start_node_id, relation, direction, start, stop, h)
  local key = 'hari:'..start_node_id..':'..relation..':'..direction
  return redis.call('zrevrange', key, start, stop)
end

function _h.sorted_set_fetch_nodes_ids(start_node_id, relation, direction, start, stop, h)
  local rels_ids = h.sorted_set_fetch_relations_ids(start_node_id, relation, direction, start, stop, h)

  local index = (direction == 'out' and 3 or 2)
  return h.map(rels_ids, function(r) return h.split(r, ':')[index] end)
end
